;────────────────────────────────────
;애무、성교等の계속、解除、処理
;────────────────────────────────────
@SHOW_TOUCH
FOR LOCAL,1,CHARANUM
	SIF TARGET:LOCAL <= 0
		CONTINUE
	SELECTCASE TEQUIP:(TARGET:LOCAL):101
		CASE 3
			PRINT 수음하다 
		CASE 4
			PRINT 펠라하다 
		CASE 6
			PRINT 역강간 
		CASE 7
			PRINT 역애널 
		CASE 8
			PRINT 풋잡하다 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):102
		CASE 1
			PRINT 스마타 
		CASE 3
			PRINT 클리애무 
		CASE 4
			PRINT 커닐링구스 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):103
		CASE 1
			PRINT 수음 
		CASE 5
			PRINT 가슴비비기 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):104
		CASE 1
			PRINT 펠라 
		CASE 2
			PRINT 커닐링구스시키다 
		CASE 4
			PRINT 키스 
		CASE 7
			PRINT 애널봉사 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):105
		CASE 1
			PRINT 파이즈리 
		CASE 3
			PRINT 가슴애무 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):질
		CASE 1
			PRINT 성교 
		CASE 3
			PRINT 손가락넣기 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):애널
		CASE 1
			PRINT 애널섹스 
		CASE 3
			PRINT 애널봉사 
		CASE 4
			PRINT 애널핥기 
	ENDSELECT
	SELECTCASE TEQUIP:(TARGET:LOCAL):108
		CASE 1
			PRINT 풋잡 
	ENDSELECT
	PRINTFORML ( %CALLNAME:(TARGET:LOCAL)%)
NEXT
PRINTL 
@TOUCH_SUCCESSION(ARG)
VARSET LOCAL
SELECTCASE SELECTCOM
	;애무
	CASE 0
		CALL TOUCH_RESET_M(3)
		CALL TOUCH_RESET_M(4)
	;커닐링구스
	CASE 1
		;성교解除
		SIF TEQUIP:ARG:질 == 1
			TEQUIP:ARG:질 = 0
		SIF TEQUIP:ARG:애널 == 1
			TEQUIP:ARG:애널 = 0
		CALL TOUCH_SET(102,4,ARG)
	;펠라한다
	CASE 2
		;성교解除
		SIF TEQUIP:ARG:질 == 1
			TEQUIP:ARG:질 = 0
		SIF TEQUIP:ARG:애널 == 1
			TEQUIP:ARG:애널 = 0
		CALL TOUCH_SET(101,4,ARG)
	;손가락挿れ
	CASE 3
		IF TEQUIP:ARG:바이브 || TEQUIP:ARG:딜도
			CALL TOUCH_RESET_M(3)
		ELSE
			CALL TOUCH_SET(106,3,ARG)
		ENDIF
	;애널舐め
	CASE 4
		;성교解除
		SIF TEQUIP:ARG:질 == 1
			TEQUIP:ARG:질 = 0
		SIF TEQUIP:ARG:애널 == 1
			TEQUIP:ARG:애널 = 0
		CALL TOUCH_SET(107,4,ARG)
	;애널애무
	CASE 5
		IF TEQUIP:ARG:애널바이브 || TEQUIP:ARG:애널비즈 || TEQUIP:ARG:관장
			CALL TOUCH_RESET_M(3)
		ELSE
			CALL TOUCH_SET(107,3,ARG)
		ENDIF
	;가슴애무
	CASE 6
		CALL TOUCH_SET(105,3,ARG)
	;유두자극
	CASE 7
		CALL TOUCH_SET(105,3,ARG)
	;조개 벌리기
	CASE 8
		CALL TOUCH_RESET_T(ARG)
	;자위
	CASE 9
	;키스한다
	CASE 20
		CALL TOUCH_SET(104,4,ARG)
	;로터
	CASE 40
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:클리토리스 = 0
		TEQUIP:ARG:페니스 = 0
	;전기마사지
	CASE 41
		CALL TOUCH_SET(0,0,0,1)
		TEQUIP:ARG:클리토리스 = 0
		TEQUIP:ARG:페니스 = 0
	;클리캡
	CASE 42
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:클리토리스 = 0
		TEQUIP:ARG:페니스 = 0
	;오나홀
	CASE 43
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:클리토리스 = 0
		TEQUIP:ARG:페니스 = 0
	;바이브
	CASE 44
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:질 = 0
	;애널바이브
	CASE 45
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:애널 = 0
	;애널비즈
	CASE 46
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:애널 = 0
	;니플캡
	CASE 47
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:가슴 = 0
	;딜도
	CASE 53
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:질 = 0


	;정상위
	CASE 60
		CALL TOUCH_SET(106,1,ARG,1)
		TEQUIP:ARG:체위 = 1
	;후배위
	CASE 61
		CALL TOUCH_SET(106,1,ARG,1)
		TEQUIP:ARG:체위 = 2
	;정상위애널
	CASE 62
		CALL TOUCH_SET(107,1,ARG,1)
		TEQUIP:ARG:체위 = 1
	;후배위애널
	CASE 63
		CALL TOUCH_SET(107,1,ARG,1)
		TEQUIP:ARG:체위 = 2
	;역 레이프
	CASE 64
		CALL TOUCH_SET(101,6,ARG,1)
		TEQUIP:MASTER:체위 = 3
	;기승위
	CASE 65
		CALL TOUCH_SET(106,1,ARG,1)
		TEQUIP:ARG:체위 = 3
	;기승위애널
	CASE 66
		CALL TOUCH_SET(107,1,ARG,1)
		TEQUIP:ARG:체위 = 3
	;대면좌위
	CASE 67
		CALL TOUCH_SET(106,1,ARG,1)
		TEQUIP:ARG:체위 = 4
	;배면좌위
	CASE 68
		CALL TOUCH_SET(106,1,ARG,1)
		TEQUIP:ARG:체위 = 5
	;대면좌위애널
	CASE 69
		CALL TOUCH_SET(107,1,ARG,1)
		TEQUIP:ARG:체위 = 4
	;배면좌위애널
	CASE 70
		CALL TOUCH_SET(107,1,ARG,1)
		TEQUIP:ARG:체위 = 5
	;二穴
	CASE 71
		IF TEQUIP:ARG:질 == 1
			TEQUIP:ARG:애널 = 0
		ELSEIF TEQUIP:ARG:애널 == 1
			TEQUIP:ARG:질 = 0
		ENDIF
	;수음
	CASE 80
		CALL TOUCH_SET(103,1,ARG)
	;펠라치오
	CASE 81
		CALL TOUCH_SET(104,1,ARG)
	;파이즈리
	CASE 82
		CALL TOUCH_SET(105,1,ARG)
	;스마타
	CASE 83
		CALL TOUCH_SET(102,1,ARG)
	;거품춤
	CASE 84
		CALL TOUCH_SET(0,0,0,1)

	;기승위
	CASE 86		
		IF TEQUIP:ARG:체위 == 3
			CALL TOUCH_SET(106,1,ARG,1)
			TEQUIP:ARG:체위 = 3
		ENDIF
	;Ａ정상위 받는다
	CASE 92
		CALL TOUCH_SET(101,7,ARG,1)
		TEQUIP:MASTER:체위 = 1
	;Ａ후배위 받는다
	CASE 93
		CALL TOUCH_SET(101,7,ARG,1)
		TEQUIP:MASTER:체위 = 2
	;Ａ기승위 한다
	CASE 94
		CALL TOUCH_SET(101,7,ARG,1)
		TEQUIP:MASTER:체위 = 3
	;스팽킹
	CASE 100
		CALL TOUCH_RESET_M(3)
	;커닐링구스 강제
	CASE 120
		CALL TOUCH_SET(104,2,ARG)
	;서로 가슴만지기
	CASE 126
		CALL TOUCH_RESET_M(3)
		TEQUIP:ARG:103 = 0
		CALL TOUCH_SET(105,3,ARG)
		CALL TOUCH_SET(103,5,ARG)
	CASE IS < 200
		CALL TOUCH_SET(0,0,0,1)
	CASE IS > 500
		CALL TOUCH_SET(0,0,0,1)
ENDSELECT


;MASTERとTARGETの접촉部位を설정する
@TOUCH_SET(TAR접촉,MAS접촉,대상_ID,リセット플래그)
#DIM DYNAMIC TAR접촉
#DIM DYNAMIC MAS접촉
#DIM DYNAMIC 대상_ID
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC リセット플래그
#DIM DYNAMIC TE部位

;ARG TARGETの접촉部位(101=페니스 102=클리토리스 103=손가락 104=입 105=가슴 106=질 107=애널)
;MAS접촉 MASTER의접촉部位(1=페니스 2=클리토리스 3=손가락 4=입 5=가슴 6=질 7=애널)
;대상_ID 대상의 캐릭터番号
;リセット플래그 真ならリセットする
VARSET LOCAL

IF リセット플래그
	FOR 캐릭터_ID,1,CHARANUM
		FOR TE部位,1,8
			TEQUIP:캐릭터_ID:(100 + TE部位) = 0
		NEXT
		;ついでに체위もリセット
		TEQUIP:캐릭터_ID:체위 = 0
		TEQUIP:캐릭터_ID:유두빨기 = 0
		TEQUIP:캐릭터_ID:Ｖ섹스 = 0
		TEQUIP:캐릭터_ID:Ａ섹스 = 0
	NEXT
ENDIF

SIF TAR접촉 <= 100
	RETURN 0
FOR 캐릭터_ID,1,CHARANUM
	FOR TE部位,1,8
		SIF TEQUIP:캐릭터_ID:(100 + TE部位) == MAS접촉
			TEQUIP:캐릭터_ID:(100 + TE部位) = 0
	NEXT
NEXT
TEQUIP:대상_ID:TAR접촉 = MAS접촉

;MASTER의접촉部位をリセットする
@TOUCH_RESET_M(ARG)
;ARG:1 MASTER의접촉部位(1=페니스 2=클리토리스 3=손가락 4=입 5=가슴 6=질 7=애널)

FOR LOCAL,1,CHARANUM
	SIF TARGET:LOCAL <= 0
		CONTINUE
	FOR LOCAL:1,1,8
		SIF TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) == ARG
			TEQUIP:(TARGET:LOCAL):(100 + LOCAL:1) = 0
	NEXT
NEXT

;TARGETの접촉部位をリセットする
@TOUCH_RESET_T(ARG)
FOR LOCAL,1,8
	TEQUIP:ARG:(100 + LOCAL) = 0
NEXT

@MASTER_POSE(占有部位,所有部位,占有이력)
;ARG MASTER의部位を占有中のTARGET:Xの部位(1=페니스 2=클리토리스 3=손가락 4=입 5=가슴 6=질 7=애널)
;ARG 0なら誰が占有しているか返す
;ARG:1 MASTER의部位(1=페니스 2=클리토리스 3=손가락 4=입 5=가슴 6=질 7=애널)
;ARG:2 真なら전턴의이력을 見る
;戻り値 MASTER의部位を占有中のTARGET:Xがいるならその캐릭터番号を返す
;MASTER_POSE(4,1,1)なら전턴(第3引数)に誰かがMASTER의페니스(第2引数)を口(第1引数)で占有していた경우、その캐릭터番号を返す
#FUNCTION
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC 占有部位
#DIM DYNAMIC 所有部位
#DIM DYNAMIC 占有이력
IF !占有部位
	FOR 캐릭터_ID,1,CHARANUM
		FOR カウンタ,1,8
			SIF TEQUIP:占有部位:(100 + カウンタ) == 所有部位
				RETURNF 캐릭터_ID
		NEXT
	NEXT
ENDIF

占有이력 = 占有이력 ? 1 # 0
FOR カウンタ,1,CHARANUM
	SIF TARGET:カウンタ <= 0
		CONTINUE
	SIF TEQUIP:(TARGET:カウンタ):(100 + 占有部位 + 10 * 占有이력) == 所有部位
		RETURNF TARGET:カウンタ
NEXT


