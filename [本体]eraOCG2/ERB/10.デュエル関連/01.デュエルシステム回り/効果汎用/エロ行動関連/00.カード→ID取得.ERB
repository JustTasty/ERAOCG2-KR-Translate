@CARD_EROTICS(カードID,듀얼리스트,正規起動)
#DIMS DYNAMIC 듀얼리스트
#DIM DYNAMIC カードID
#DIM DYNAMIC 確認カードID
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 正規起動
VARSET RESULT


TRYCALLFORM CARD_{カードID}("連動ID")
SIF RESULT > 0
	カードID = RESULT

SELECTCASE カードID
;謎のレウス헌터さん
	CASE 36650
		IF 듀얼리스트 == "자신"
			確認カードID = MASTER
		ELSE
			確認カードID = OPPOSER
		ENDIF

	CASE MASTER補助, 9990
		確認カードID = MASTER
		
	CASE 상대プレイヤー
		IF 듀얼리스트 == "자신"
			RETURN OPPOSER
		ELSE
			RETURN MASTER
		ENDIF
		RETURN -1


	CASE 상대プレイヤー
		IF 듀얼리스트 == "자신"
			RETURN OPPOSER
		ELSE
			RETURN MASTER
		ENDIF
		RETURN -1
	CASEELSE
		確認カードID = カードID
ENDSELECT

VARSET 캐릭터_ID, -1
FOR カウンタ,1,CHARANUM
	IF NO:カウンタ == 確認カードID
		캐릭터_ID = カウンタ
		RETURN 캐릭터_ID
	ENDIF
NEXT
RETURN -1



@FIND_CHARA_GID(캐릭터_ID,CNT설정)
#DIMS DYNAMIC 듀얼리스트
#DIM DYNAMIC カードID
#DIM DYNAMIC 確認カードID
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 正規起動
#DIM DYNAMIC CNT설정
#DIM DYNAMIC 条件合致数
#DIM DYNAMIC 条件合致ID,100

;【条件달성０】そのカード_IDがあるなら返す
カードID = NO:캐릭터_ID
IF ENUMFILES("RESOURCES/DUEL", @"{カードID}_DUEL.*")
	IF CNT설정 == 1
		条件合致ID:条件合致数 = カードID
		条件合致数 ++
	ELSE
		RETURN カードID
	ENDIF
ENDIF
;＞＞　第２チェック、その他カード　＜─────────────────────────────────────
;総当たり
FOR カードID,10000,70000
	VARSET RESULTS
	TRYCALLFORM CARDNAME_{カードID}, "名前"
	SIF RESULTS == ""
		CONTINUE
	CALL CARD_EROTICS(カードID)
	SIF RESULT != 캐릭터_ID
		CONTINUE
	IF ENUMFILES("RESOURCES/DUEL", @"{カードID}_DUEL.*")
		IF CNT설정 == 1
			条件合致ID:条件合致数 = カードID
			条件合致数 ++
		ELSE
			RETURN カードID
		ENDIF
	ENDIF
NEXT
IF CNT설정 == 1
	FOR カウンタ,0,10
		RESULT:(カウンタ + 1) = 条件合致ID:カウンタ
	NEXT	
	RETURN 条件合致数
ENDIF
RETURN -1

@CARD_EROTICS_FIELD(듀얼리스트,ゾーン,場所,反転플래그)
#DIMS DYNAMIC 듀얼리스트
#DIMS DYNAMIC 対面者
#DIMS DYNAMIC 대상者
#DIMS DYNAMIC ゾーン
#DIM DYNAMIC 場所
#DIM DYNAMIC カード_ID
#DIM DYNAMIC 조교대상
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 選択カード
#DIM DYNAMIC 효과蓄積
#DIM DYNAMIC 反転플래그


CALL 対面者판정(듀얼리스트)
対面者 = %RESULTS%

IF 反転플래그 == 1
	대상者 = %対面者%
ELSE
	대상者 = %듀얼리스트%
ENDIF


IF ゾーン == "필드"
	カード_ID = GETVAR(@"%대상者%_필드:場所")
	IF GETVAR(@"%대상者%_MZ_変化元ID:場所") > -1
		カード_ID = GETVAR(@"%대상者%_MZ_変化元ID:場所")
	ENDIF
ELSEIF ゾーン == "마함"
	カード_ID = GETVAR(@"%대상者%_마함:場所")
	IF GETVAR(@"%대상者%_魔_変化元ID:場所") > -1
		カード_ID = GETVAR(@"%대상者%_魔_変化元ID:場所")
	ENDIF
ELSE
	カード_ID = GETVAR(@"%対面者%_%ゾーン%:場所")
ENDIF
CALL CARD_EROTICS(カード_ID)



RETURN RESULT