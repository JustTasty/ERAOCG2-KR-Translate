

;情報更新────────────────────────────────────────────────────────────────────────────────────────────────────────────────
@CARD_LOADUP;連続的な更新
#DIMS DYNAMIC 決闘者
#DIM DYNAMIC カウンタ
#DIM DYNAMIC カウンタB
#DIMS DYNAMIC 対面者

#DIM DYNAMIC キャラ番号
#DIM DYNAMIC カードID
#DIM DYNAMIC 設定場所
#DIM DYNAMIC 性別判定
#DIM DYNAMIC 実性別判定
#DIM DYNAMIC カード_ID

決闘者 = %ターンプレイヤー%
CALL RESET_PROHIB




$INPUT_LOOP1
CALL 対面者判定(決闘者)
対面者 = %RESULTS%


SIF GETVAR(@"%決闘者%_ADV不可") == 3
	SETVAR @"%決闘者%_ADV不可", 0
SIF GETVAR(@"%決闘者%_SS阻害状態") == 3
	SETVAR @"%決闘者%_SS阻害状態", 0
SIF GETVAR(@"%決闘者%_光阻害状態") == 3
	SETVAR @"%決闘者%_光阻害状態", 0

SIF GETVAR(@"%決闘者%_墓地_無効") == 3
	SETVAR @"%決闘者%_墓地_無効", 0

SIF GETVAR(@"%決闘者%_除外_無効") == 3
	SETVAR @"%決闘者%_除外_無効", 0

SIF GETVAR(@"%決闘者%_効果ダメージ無効") == 3
	SETVAR @"%決闘者%_効果ダメージ無効", 0

SIF GETVAR(@"%決闘者%_効果ダメージ反射") == 3
	SETVAR @"%決闘者%_効果ダメージ反射", 0

SIF GETVAR(@"%決闘者%_ぺギア") == 3
	SETVAR @"%決闘者%_ぺギア", 0
SIF GETVAR(@"%決闘者%_アザミナ呪") == 3
	SETVAR @"%決闘者%_アザミナ呪", 0
SIF GETVAR(@"%決闘者%_モン阻害") == 3
	SETVAR @"%決闘者%_モン阻害", 0
SIF GETVAR(@"%決闘者%_速魔阻害") == 3
	SETVAR @"%決闘者%_速魔阻害", 0
SIF GETVAR(@"%決闘者%_通罠阻害") == 3
	SETVAR @"%決闘者%_通罠阻害", 0
SIF GETVAR(@"%決闘者%_永罠阻害") == 3
	SETVAR @"%決闘者%_永罠阻害", 0
SIF GETVAR(@"%決闘者%_水属阻害") == 3
	SETVAR @"%決闘者%_水属阻害", 0
SIF GETVAR(@"%決闘者%_特殊阻害中止") == 3
	SETVAR @"%決闘者%_特殊阻害中止", 0

SIF GETVAR(@"%決闘者%_単体攻撃") == 3
	SETVAR @"%決闘者%_単体攻撃", 0

SIF GETVAR(@"%決闘者%_魔香効果") == 3
	SETVAR @"%決闘者%_魔香効果", 0

SIF GETVAR(@"%決闘者%_逆魔香効果") == 3
	SETVAR @"%決闘者%_逆魔香効果", 0

SIF GETVAR(@"%決闘者%_魔法制限") == 3
	SETVAR @"%決闘者%_魔法制限", 0

SIF GETVAR(@"%決闘者%_登場時無効") == 3
	SETVAR @"%決闘者%_登場時無効", 0

SIF GETVAR(@"%決闘者%_除外置換") == 3
	SETVAR @"%決闘者%_除外置換", 0
SIF GETVAR(@"%決闘者%_地除外置換") == 3
	SETVAR @"%決闘者%_地除外置換", 0
SIF GETVAR(@"%決闘者%_魔除外置換") == 3
	SETVAR @"%決闘者%_魔除外置換", 0
SIF GETVAR(@"%決闘者%_空除外置換") == 3
	SETVAR @"%決闘者%_空除外置換", 0
SIF GETVAR(@"%決闘者%_除外NG置換") == 3
	SETVAR @"%決闘者%_除外NG置換", 0
SIF GETVAR(@"%決闘者%_ドロー不可") == 3
	SETVAR @"%決闘者%_ドロー不可", 0

SIF GETVAR(@"%決闘者%_FUS効果無効") == 3
	SETVAR @"%決闘者%_FUS効果無効", 0
SIF GETVAR(@"%決闘者%_SYN効果無効") == 3
	SETVAR @"%決闘者%_SYN効果無効", 0
SIF GETVAR(@"%決闘者%_XYZ効果無効") == 3
	SETVAR @"%決闘者%_XYZ効果無効", 0
SIF GETVAR(@"%決闘者%_LIN効果無効") == 3
	SETVAR @"%決闘者%_LIN効果無効", 0
SIF GETVAR(@"%決闘者%_モン効果無効") == 3
	SETVAR @"%決闘者%_モン効果無効", 0



SIF GETVAR(@"%決闘者%_魔罠無効") == 3
	SETVAR @"%決闘者%_魔罠無効", 0
SIF GETVAR(@"%決闘者%_魔無効") == 3
	SETVAR @"%決闘者%_魔無効", 0
SIF GETVAR(@"%決闘者%_罠無効") == 3
	SETVAR @"%決闘者%_罠無効", 0
SIF GETVAR(@"%決闘者%_通常無効") == 3
	SETVAR @"%決闘者%_通常無効", 0
SIF GETVAR(@"%決闘者%_逆通常無効") == 3
	SETVAR @"%決闘者%_逆通常無効", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止魔罠") == 3
	SETVAR @"%決闘者%_SS召喚禁止魔罠", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止手札") == 3
	SETVAR @"%決闘者%_SS召喚禁止手札", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止墓地") == 3
	SETVAR @"%決闘者%_SS召喚禁止墓地", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止デッキ") == 3
	SETVAR @"%決闘者%_SS召喚禁止デッキ", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止EXデッキ") == 3
	SETVAR @"%決闘者%_SS召喚禁止EXデッキ", 0

SIF GETVAR(@"%決闘者%_SS召喚禁止除外") == 3
	SETVAR @"%決闘者%_SS召喚禁止除外", 0

SIF GETVAR(@"%決闘者%_レベル５制限") == 3
	SETVAR @"%決闘者%_レベル５制限", 0





FOR カウンタ,0,5
	IF GETVAR(@"%決闘者%_戦場:カウンタ") == -1
		SETVAR @"%決闘者%_MZ_表:カウンタ", 0
		SETVAR @"%決闘者%_MZ_Ｘ:カウンタ", -1
		SETVAR @"%決闘者%_MZ_戦:カウンタ", -1
		SETVAR @"%決闘者%_MZ_個ID:カウンタ", -1
		SETVAR @"%決闘者%_MZ_戦済:カウンタ", 0
		SETVAR @"%決闘者%_MZ_召種:カウンタ", 0
		SETVAR @"%決闘者%_MZ_T1召種:カウンタ", 0

		SETVAR @"%決闘者%_MZ_効済:カウンタ", 0
		SETVAR @"%決闘者%_MZ_効発:カウンタ", 0
		SETVAR @"%決闘者%_MZ_表変:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一時:カウンタ", 0

		;耐性効果
		SETVAR @"%決闘者%_MZ_破耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_戦耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_対耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_無差耐:カウンタ", 0

		SETVAR @"%決闘者%_MZ_モ耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_魔耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_罠耐:カウンタ", 0
		SETVAR @"%決闘者%_MZ_忠実:カウンタ", 0

		SETVAR @"%決闘者%_MZ_一破:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一破済:カウンタ", 0

		
		;デメリット効果
		SETVAR @"%決闘者%_MZ_無効:カウンタ", 0
		SETVAR @"%決闘者%_MZ_発無:カウンタ", 0
		SETVAR @"%決闘者%_MZ_表固:カウンタ", 0
		SETVAR @"%決闘者%_MZ_不材:カウンタ", 0
		SETVAR @"%決闘者%_MZ_除処:カウンタ", 0

		;戦闘系効果の効果
		SETVAR @"%決闘者%_MZ_戦無:カウンタ", 0
		SETVAR @"%決闘者%_MZ_直無:カウンタ", 0
		SETVAR @"%決闘者%_MZ_単攻:カウンタ", 0
		SETVAR @"%決闘者%_MZ_戦狂:カウンタ", 0
		SETVAR @"%決闘者%_MZ_追戦:カウンタ", 0
		SETVAR @"%決闘者%_MZ_連戦:カウンタ", 0
		SETVAR @"%決闘者%_MZ_守戦:カウンタ", 0
		SETVAR @"%決闘者%_MZ_戦除:カウンタ", 0	;ザポルグ追記20241227

		SETVAR @"%決闘者%_MZ_攻誘:カウンタ", 0
		SETVAR @"%決闘者%_MZ_攻避:カウンタ", 0

		SETVAR @"%決闘者%_MZ_貫通:カウンタ", 0
		SETVAR @"%決闘者%_MZ_直攻:カウンタ", 0

		;効果阻害
		SETVAR @"%決闘者%_MZ_EX阻:カウンタ", 0
		SETVAR @"%決闘者%_MZ_阻害:カウンタ", 0

		SETVAR @"%決闘者%_MZ_戦阻:カウンタ", 0

		;カウンタ系
		SETVAR @"%決闘者%_MZ_魔Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_個Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_悪Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_汎数:カウンタ", 0
		SETVAR @"%決闘者%_MZ_T1汎数:カウンタ", 0
		SETVAR @"%決闘者%_MZ_リ数:カウンタ", 0

		;R-18効果
		SETVAR @"%決闘者%_MZ_接可:カウンタ", 0
		SETVAR @"%決闘者%_MZ_調教:カウンタ", 0
		SETVAR @"%決闘者%_MZ_薬Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_発情:カウンタ", 0
		SETVAR @"%決闘者%_MZ_胸追:カウンタ", 0
		SETVAR @"%決闘者%_MZ_服状:カウンタ", 0
		SETVAR @"%決闘者%_MZ_言発:カウンタ", 0 ;Anonym追記

		;ステータス変動（永続）
		SETVAR @"%決闘者%_MZ_永星:カウンタ", 0
		SETVAR @"%決闘者%_MZ_永属:カウンタ", 0
		SETVAR @"%決闘者%_MZ_永種:カウンタ", 0
		SETVAR @"%決闘者%_MZ_永Ｔ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_永性:カウンタ", 0 ;ザポルグ追記20250218

		SETVAR @"%決闘者%_MZ_永攻:カウンタ", 0
		SETVAR @"%決闘者%_MZ_永守:カウンタ", 0
		SETVAR @"%決闘者%_MZ_攻固:カウンタ", -1
		SETVAR @"%決闘者%_MZ_MAX成立:カウンタ", 0

		SETVAR @"%決闘者%_MZ_追カテ:カウンタ", ""
		SETVAR @"%決闘者%_MZ_追カテ2:カウンタ", ""
		SETVAR @"%決闘者%_MZ_改名:カウンタ", ""

		;ステータス変動（一時）
		SETVAR @"%決闘者%_MZ_一星:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一属:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一種:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一Ｔ:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一攻:カウンタ", 0
		SETVAR @"%決闘者%_MZ_一守:カウンタ", 0

		;その他
		SETVAR @"%決闘者%_MZ_条達:カウンタ", 0
		SETVAR @"%決闘者%_MZ_終処:カウンタ", 0
		SETVAR @"%決闘者%_MZ_終戦:カウンタ", 0
		SETVAR @"%決闘者%_MZ_束縛:カウンタ", -1
		SETVAR @"%決闘者%_MZ_所有:カウンタ", 0

		SETVAR @"%決闘者%_MZ_特殊状態:カウンタ", 0
		SETVAR @"%決闘者%_MZ_変化元ID:カウンタ", -1
	ENDIF



	;耐性効果
	SIF GETVAR(@"%決闘者%_MZ_破耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_破耐:カウンタ", 0	
	SIF GETVAR(@"%決闘者%_MZ_戦耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_戦耐:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_対耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_対耐:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_無差耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_無差耐:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_モ耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_モ耐:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_魔耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_魔耐:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_罠耐:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_罠耐:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_一破:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_一破:カウンタ", 0	

	;デメリット効果
	SIF GETVAR(@"%決闘者%_MZ_無効:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_無効:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_発無:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_発無:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_表固:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_表固:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_不材:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_不材:カウンタ", 0

	;戦闘系効果の効果
	SIF GETVAR(@"%決闘者%_MZ_戦無:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_戦無:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_直無:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_直無:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_単攻:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_単攻:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_戦狂:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_戦狂:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_追戦:カウンタ") >= 1
		SETVAR @"%決闘者%_MZ_追戦:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_連戦:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_連戦:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_守戦:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_守戦:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_戦除:カウンタ") == 3	;ザポルグ追記20241227
		SETVAR @"%決闘者%_MZ_戦除:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_攻誘:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_攻誘:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_攻避:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_攻避:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_貫通:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_貫通:カウンタ", 0
	SIF GETVAR(@"%決闘者%_MZ_直攻:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_直攻:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_MAX成立:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_MAX成立:カウンタ", 0

	;効果阻害
	SIF GETVAR(@"%決闘者%_MZ_EX阻:カウンタ") >= 3
		SETVAR @"%決闘者%_MZ_EX阻:カウンタ", 0

	SETVAR @"%決闘者%_MZ_SS阻（種類）:カウンタ", 0
	SETVAR @"%決闘者%_MZ_EX阻（種類）:カウンタ", 0
	SETVAR @"%決闘者%_MZ_SS阻（種族）:カウンタ", 0
	SETVAR @"%決闘者%_MZ_SS阻（属性）:カウンタ", 0
	SETVAR @"%決闘者%_MZ_SS阻（レベル）:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_阻害:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_阻害:カウンタ", 0

	SIF GETVAR(@"%決闘者%_MZ_戦阻:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_戦阻:カウンタ", 0


	SIF GETVAR(@"%決闘者%_MZ_接可:カウンタ") == 3
		SETVAR @"%決闘者%_MZ_接可:カウンタ", 0
NEXT

FOR カウンタ,0,5
	IF GETVAR(@"%決闘者%_魔罠:カウンタ") == -1
		SETVAR @"%決闘者%_魔_表:カウンタ", 0
		SETVAR @"%決闘者%_魔_所有:カウンタ", 0
		SETVAR @"%決闘者%_魔_装:カウンタ", 5
		SETVAR @"%決闘者%_魔_武種:カウンタ", 0


		SETVAR @"%決闘者%_魔_無効:カウンタ", 0
		SETVAR @"%決闘者%_魔_破耐:カウンタ", 0
		SETVAR @"%決闘者%_魔_対耐:カウンタ", 0
		SETVAR @"%決闘者%_魔_阻害:カウンタ", 0
		SETVAR @"%決闘者%_魔_効済:カウンタ", 0

		;カウンタ系
		SETVAR @"%決闘者%_魔_汎数:カウンタ", 0
		SETVAR @"%決闘者%_魔_T1汎数:カウンタ", 0
		SETVAR @"%決闘者%_魔_リ数:カウンタ", 0
		SETVAR @"%決闘者%_魔_魔Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_魔_個Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_魔_悪Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_魔_薬Ｃ:カウンタ", 0
		SETVAR @"%決闘者%_魔_発無:カウンタ", 0

		SETVAR @"%決闘者%_魔_一破:カウンタ", 0
		SETVAR @"%決闘者%_魔_一破済:カウンタ", 0
		SETVAR @"%決闘者%_魔_追カテ:カウンタ", ""
		SETVAR @"%決闘者%_魔_追カテ2:カウンタ", ""
		SETVAR @"%決闘者%_魔_改名:カウンタ", ""
		SETVAR @"%決闘者%_魔_除処:カウンタ", 0
	ELSE
		SIF GETVAR(@"%決闘者%_魔_表:カウンタ") >= 2
			SETVAR @"%決闘者%_魔_装:カウンタ", 5
	ENDIF
	SIF GETVAR(@"%決闘者%_魔_破耐:カウンタ") == 3
		SETVAR @"%決闘者%_魔_破耐:カウンタ", 0	
	SIF GETVAR(@"%決闘者%_魔_対耐:カウンタ") == 3
		SETVAR @"%決闘者%_魔_対耐:カウンタ", 0	
	SIF GETVAR(@"%決闘者%_魔_阻害:カウンタ") == 3
		SETVAR @"%決闘者%_魔_阻害:カウンタ", 0
	SIF GETVAR(@"%決闘者%_魔_一破:カウンタ") == 3
		SETVAR @"%決闘者%_魔_一破:カウンタ", 0
	SIF GETVAR(@"%決闘者%_魔_発無:カウンタ") == 3
		SETVAR @"%決闘者%_魔_発無:カウンタ", 0



NEXT

SETVAR @"%決闘者%_フィールド名", ""
SETVAR @"%決闘者%_カテ阻害", ""


FOR カウンタ,0,紙束最大値
	IF GETVAR(@"%決闘者%_除外:カウンタ") == -1
		SETVAR @"%決闘者%_除_帰還:カウンタ", 0
		SETVAR @"%決闘者%_除_変化元ID:カウンタ", 0
	ENDIF
NEXT



FOR カウンタ,0,紙束最大値
	IF GETVAR(@"%決闘者%_手札:カウンタ") == -1
		SETVAR @"%決闘者%_手_召可:カウンタ", 0
		SETVAR @"%決闘者%_手_一星:カウンタ", 0
		SETVAR @"%決闘者%_手_永星:カウンタ", 0
	ENDIF
	SIF GETVAR(@"%決闘者%_手_一星:カウンタ") >= 1
		SETVAR @"%決闘者%_手_一星:カウンタ", 0
	SIF GETVAR(@"%決闘者%_手_永星:カウンタ") >= 1
		SETVAR @"%決闘者%_手_一星:カウンタ", GETVAR(@"%決闘者%_手_一星:カウンタ") + GETVAR(@"%決闘者%_手_永星:カウンタ")
	SIF GETVAR(@"%決闘者%_手_召可:カウンタ") == 3
		SETVAR @"%決闘者%_手_召可:カウンタ", 0
NEXT


FOR カウンタ,0,5
	SETVAR @"%決闘者%_MZ_ID:カウンタ", GETVAR(@"%決闘者%_戦場:カウンタ")
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "攻撃力"
	SETVAR @"%決闘者%_MZ_攻:カウンタ", RESULT
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "守備力"
	SETVAR @"%決闘者%_MZ_守:カウンタ", RESULT
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "属性"
	SETVAR @"%決闘者%_MZ_属:カウンタ", RESULT
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "種族"
	SETVAR @"%決闘者%_MZ_種:カウンタ", RESULT
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "レベル"
	SETVAR @"%決闘者%_MZ_星:カウンタ", RESULT
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "チューナー"
	SETVAR @"%決闘者%_MZ_Ｔ:カウンタ", RESULT

	IF GETVAR(@"%決闘者%_MZ_変化元ID:カウンタ") >= 1
		TRYCALLFORM CARD_{GETVAR(@"%決闘者%_MZ_変化元ID:カウンタ")}, "性別"
	ELSE
		TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}, "性別"
	ENDIF

	SETVAR @"%決闘者%_MZ_性:カウンタ", RESULT
	IF オプション_性別
		キャラ番号 = NO_TO_CHARANUM(GETVAR(@"%決闘者%_戦場:カウンタ"))
		IF キャラ番号 >= 1
			SETVAR @"%決闘者%_MZ_性:カウンタ", TALENT:キャラ番号:性別
		ENDIF
	ENDIF
NEXT

FOR カウンタ,0,5
	SETVAR @"%決闘者%_魔_ID:カウンタ", GETVAR(@"%決闘者%_魔罠:カウンタ")
NEXT



FOR カウンタ,0,5
	SETVAR @"%決闘者%_MZ_攻:カウンタ", GETVAR(@"%決闘者%_MZ_攻:カウンタ") + GETVAR(@"%決闘者%_MZ_一攻:カウンタ")
	SETVAR @"%決闘者%_MZ_守:カウンタ", GETVAR(@"%決闘者%_MZ_守:カウンタ") + GETVAR(@"%決闘者%_MZ_一守:カウンタ")

	SETVAR @"%決闘者%_MZ_攻:カウンタ", GETVAR(@"%決闘者%_MZ_攻:カウンタ") + GETVAR(@"%決闘者%_MZ_一時:カウンタ")

	SETVAR @"%決闘者%_MZ_攻:カウンタ", GETVAR(@"%決闘者%_MZ_攻:カウンタ") + GETVAR(@"%決闘者%_MZ_永攻:カウンタ")
	SETVAR @"%決闘者%_MZ_守:カウンタ", GETVAR(@"%決闘者%_MZ_守:カウンタ") + GETVAR(@"%決闘者%_MZ_永守:カウンタ")



	SIF GETVAR(@"%決闘者%_MZ_攻固:カウンタ") != -1
		SETVAR @"%決闘者%_MZ_攻:カウンタ", GETVAR(@"%決闘者%_MZ_攻固:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_永属:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_属:カウンタ", GETVAR(@"%決闘者%_MZ_永属:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_永種:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_種:カウンタ", GETVAR(@"%決闘者%_MZ_永種:カウンタ")
	
	SIF GETVAR(@"%決闘者%_MZ_永星:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_星:カウンタ", GETVAR(@"%決闘者%_MZ_永星:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_永Ｔ:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_Ｔ:カウンタ", GETVAR(@"%決闘者%_MZ_永Ｔ:カウンタ")
	;ザポルグ追記20250218
	SIF GETVAR(@"%決闘者%_MZ_永性:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_性:カウンタ", GETVAR(@"%決闘者%_MZ_永性:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_一星:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_星:カウンタ", GETVAR(@"%決闘者%_MZ_一星:カウンタ")
	
	SIF GETVAR(@"%決闘者%_MZ_一Ｔ:カウンタ")
		SETVAR @"%決闘者%_MZ_Ｔ:カウンタ", GETVAR(@"%決闘者%_MZ_一Ｔ:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_一属:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_属:カウンタ", GETVAR(@"%決闘者%_MZ_一属:カウンタ")

	SIF GETVAR(@"%決闘者%_MZ_一種:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_種:カウンタ", GETVAR(@"%決闘者%_MZ_一種:カウンタ")

	IF GETVAR(@"%決闘者%_MZ_一性:カウンタ") != 0
		SETVAR @"%決闘者%_MZ_性:カウンタ", GETVAR(@"%決闘者%_MZ_一性:カウンタ")
	ENDIF


NEXT

;Anonym追加 ヴァンガード超次元用
FOR カウンタ,0,5
	SIF GETVAR(@"%決闘者%_戦場:カウンタ") == -1
		CONTINUE
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}("種類")
	SIF !MATCH(RESULT,超次元)
		CONTINUE
	TRYCALLFORM CARDNAME_{GETVAR(@"%決闘者%_戦場:カウンタ")}("カテゴリ")
	SIF !MATCH(RESULTS,"ヴァンガード")
		CONTINUE
	SIF GETVAR(@"%決闘者%_MZ_変化元ID:カウンタ") <= 0
		CONTINUE
	VARSET カード_ID
	カード_ID = GETVAR(@"%決闘者%_MZ_変化元ID:カウンタ")
	TRYCALLFORM CARD_{カード_ID},"攻撃力"
	SETVAR @"%決闘者%_MZ_攻:カウンタ", RESULT + GETVAR(@"%決闘者%_MZ_攻:カウンタ")
	TRYCALLFORM CARD_{カード_ID},"守備力"
	SETVAR @"%決闘者%_MZ_守:カウンタ", RESULT + GETVAR(@"%決闘者%_MZ_守:カウンタ")
NEXT

;戦闘中のカードリセット
IF 戦闘場所(決闘者) != 5
	SIF 戦闘カードID(決闘者) == -1
		SETVAR @"%決闘者%_戦闘カード", 5
ENDIF

FOR カウンタ,0,5
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_魔罠:カウンタ")}("分割")
	IF RESULT == クロスギア
		IF GETVAR(@"%決闘者%_魔_装:カウンタ") >= 6
			IF GETVAR(@"%対面者%_戦場:((%決闘者%_魔_装:カウンタ) - 6)") == -1 && GETVAR(@"%決闘者%_魔_表:カウンタ") == 1
				SETVAR @"%決闘者%_魔_装:カウンタ", 5
			ENDIF
		ELSEIF GETVAR(@"%決闘者%_魔_装:カウンタ") <= 4
			IF GETVAR(@"%決闘者%_戦場:(%決闘者%_魔_装:カウンタ)") == -1 && GETVAR(@"%決闘者%_魔_表:カウンタ") == 1
				SETVAR @"%決闘者%_魔_装:カウンタ", 5
			ENDIF
		ENDIF
	ELSE
		IF GETVAR(@"%決闘者%_魔_装:カウンタ") >= 6
			IF GETVAR(@"%対面者%_戦場:((%決闘者%_魔_装:カウンタ) - 6)") == -1 && GETVAR(@"%決闘者%_魔_表:カウンタ") == 1
				CALL CARD_DISPOSE(決闘者,"魔罠",カウンタ,絶対破壊行き)
			ENDIF
		ELSEIF GETVAR(@"%決闘者%_魔_装:カウンタ") <= 4
			IF GETVAR(@"%決闘者%_戦場:(%決闘者%_魔_装:カウンタ)") == -1 && GETVAR(@"%決闘者%_魔_表:カウンタ") == 1
				CALL CARD_DISPOSE(決闘者,"魔罠",カウンタ,絶対破壊行き)
			ENDIF
		ENDIF
	ENDIF
NEXT

FOR カウンタ,0,5
	SIF GETVAR(@"%決闘者%_戦場:カウンタ") == -1
		CONTINUE
	SIF GETVAR(@"%決闘者%_戦場:カウンタ") != 使用不可ゾーン
		CONTINUE
	設定場所 = GETVAR(@"%決闘者%_MZ_汎数:カウンタ")
	IF 設定場所 >= 6
		設定場所 -= 10
		SIF GETVAR(@"%対面者%_戦場:設定場所") == -1
			SETVAR @"%決闘者%_戦場:カウンタ", -1
	ELSEIF 設定場所 <= 4
		SIF GETVAR(@"%対面者%_戦場:設定場所") == -1
			SETVAR @"%決闘者%_戦場:カウンタ", -1
	ENDIF
NEXT

VARSET カードID
FOR カウンタ,0,5
	SIF GETVAR(@"%決闘者%_戦場:カウンタ") == -1
		CONTINUE
	SIF GETVAR(@"%決闘者%_MZ_表:カウンタ") == 3
		CONTINUE
	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_戦場:カウンタ")}("単一存在")
	IF RESULT == 1
		カードID = GETVAR(@"%決闘者%_戦場:カウンタ")
		FOR カウンタB,0,5
			SIF カウンタB == カウンタ
				CONTINUE
			SIF GETVAR(@"%決闘者%_戦場:カウンタB") != カードID
				CONTINUE
			CALL CARD_DISPOSE(決闘者,"戦場",カウンタB,10)
		NEXT
	ENDIF
NEXT
VARSET カードID
FOR カウンタ,0,5
	SIF GETVAR(@"%決闘者%_魔罠:カウンタ") == -1
		CONTINUE
	SIF GETVAR(@"%決闘者%_魔_表:カウンタ") != 1
		CONTINUE

	TRYCALLFORM CARD_{GETVAR(@"%決闘者%_魔罠:カウンタ")}("単一存在")
	IF RESULT == 1
		カードID = GETVAR(@"%決闘者%_魔罠:カウンタ")
		FOR カウンタB,0,5
			SIF カウンタB == カウンタ
				CONTINUE
			SIF GETVAR(@"%決闘者%_魔罠:カウンタB") != カードID
				CONTINUE
			CALL CARD_DISPOSE(決闘者,"魔罠",カウンタB,10)
		NEXT
	ENDIF
NEXT


IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP1
ENDIF

CALL ENSLAVE_RELEASE


CALLFORM CONTINUOUS_NEGATE(ターンプレイヤー)
CALLFORM CONTINUOUS_EFFECT(ターンプレイヤー)
CALLFORM CONTINUOUS_ATK_EFFECT(ターンプレイヤー)
CALLFORM CONTINUOUS_EFFECT(ターンプレイヤー)






決闘者 = %ターンプレイヤー%
CALL 対面者判定(決闘者)
対面者 = %RESULTS%
$INPUT_LOOP4





IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP4
ENDIF


FOR カウンタ,0,5
	SIF 自分_MZ_攻:カウンタ <= 0
		自分_MZ_攻:カウンタ = 0
	SIF 自分_MZ_守:カウンタ <= 0
		自分_MZ_守:カウンタ = 0
	SIF 自分_MZ_星:カウンタ <= 1
		自分_MZ_星:カウンタ = 1
NEXT
FOR カウンタ,0,5
	SIF 相手_MZ_攻:カウンタ <= 0
		相手_MZ_攻:カウンタ = 0
	SIF 相手_MZ_守:カウンタ <= 0
		相手_MZ_守:カウンタ = 0
	SIF 相手_MZ_星:カウンタ <= 1
		相手_MZ_星:カウンタ = 1
NEXT


FOR カウンタ,0,CHARANUM
	CFLAG:カウンタ:竿具現化 = 0
	CFLAG:カウンタ:膣具現化 = 0
	CFLAG:カウンタ:追加胸サイズ = 0
	CFLAG:カウンタ:催眠状態 = 0
NEXT

決闘者 = %ターンプレイヤー%
CALL 対面者判定(決闘者)
対面者 = %RESULTS%
$INPUT_LOOP5
FOR カウンタ,0,5
	;キャラクター番号持ちのキャラかを判定する	 
	カード_ID = GETVAR(@"%決闘者%_戦場:カウンタ")
	キャラ番号 = NO_TO_CHARANUM(カード_ID)
	IF キャラ番号 >= 1
		性別判定 = GETVAR(@"%決闘者%_MZ_一性:カウンタ")
		実性別判定 = TALENT:キャラ番号:性別
		;ふたなりで元女ならとりあえず竿の具現化
		IF 実性別判定 == 1 || 実性別判定 == 3
			SIF 性別判定 == 3
				CFLAG:キャラ番号:竿具現化 = 1
			SIF 性別判定 == 2
				CFLAG:カウンタ:追加胸サイズ = GETVAR(@"%決闘者%_MZ_胸追:カウンタ")
		;男が女体化しているのなら膣どうぞ
		ELSEIF 実性別判定 == 2
			SIF 性別判定 != 2
				CFLAG:キャラ番号:膣具現化 = 1
		ENDIF
	ENDIF
NEXT

IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP5
ENDIF


FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{自分_手札:カウンタ}("自分",エクゾ起動,"手札",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{相手_手札:カウンタ}("相手",エクゾ起動,"手札",カウンタ)
NEXT







@CONTINUOUS_EFFECT(決闘者)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC 対面者
#DIM DYNAMIC カウンタ

決闘者 = %ターンプレイヤー%
CALL 対面者判定(決闘者)
対面者 = %RESULTS%
$INPUT_LOOP

CALLFORM CARD_EMBLEM_ACT(決闘者, "短紋章")
CALLFORM CARD_EMBLEM_ACT(決闘者, "永紋章")
FOR カウンタ,0,5
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,永続効果,"戦場",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,永続効果,"戦場",カウンタ)
NEXT
FOR カウンタ,0,5
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,永続効果,"魔罠",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,永続効果,"魔罠",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_手札:カウンタ")}(決闘者,永続効果,"手札",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_手札:カウンタ")}(決闘者,永続効果,"手札",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,永続効果,"墓地",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,永続効果,"墓地",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,永続効果,"除外",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,永続効果,"除外",カウンタ)
NEXT


FOR カウンタ,1,4
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,マキシマム条件,"戦場",カウンタ)
	IF RESULT == 1
		SETVAR @"%決闘者%_MZ_MAX成立:カウンタ", 3
		IF カウンタ == 2
			CALL STATCHANGE_EFFECT(決闘者,"自身",カウンタ,"魔耐")
			CALL STATCHANGE_EFFECT(決闘者,"自身",カウンタ,"罠耐")
			CALL STATCHANGE_EFFECT(決闘者,"自身",カウンタ,"モ耐")
		ENDIF
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,マキシマム条件,"戦場",カウンタ)
	ENDIF
NEXT


IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP
ENDIF

@CONTINUOUS_ATK_EFFECT(決闘者)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC 対面者
#DIM DYNAMIC カウンタ
#DIM DYNAMIC 攻撃修正
#DIM DYNAMIC 守備修正
#DIMS DYNAMIC 非ターンプレイヤー

決闘者 = %ターンプレイヤー%
CALL 対面者判定(決闘者)
対面者 = %RESULTS%
非ターンプレイヤー = %対面者% 
$INPUT_LOOP


CALLFORM CARD_EMBLEM_ACT(決闘者, "攻紋章")
CALLFORM CARD_EMBLEM_ACT(決闘者, "永攻紋章")
FOR カウンタ,0,5
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,攻守変動,"戦場",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,攻守変動,"戦場",カウンタ)
NEXT
FOR カウンタ,0,5

	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,攻守変動,"魔罠",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,攻守変動,"魔罠",カウンタ)

	IF GETBIT(GETVAR(@"%決闘者%_魔_武種:カウンタ"),0) == 1
		VARSET 攻撃修正
		VARSET 守備修正
		TRYCALLFORM CARD_{GETVAR(@"%決闘者%_魔罠:カウンタ")},"攻撃力"
		攻撃修正 = RESULT
		IF GETBIT(GETVAR(@"%決闘者%_魔_武種:カウンタ"),1) == 1
			TRYCALLFORM CARD_{GETVAR(@"%決闘者%_魔罠:カウンタ")},"守備力"
			守備修正 = RESULT
		ENDIF
		CALL STATCHANGE_BASIC(決闘者,"装備",カウンタ,攻撃修正,守備修正)
	ENDIF
NEXT

FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_手札:カウンタ")}(決闘者,攻守変動,"手札",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_手札:カウンタ")}(決闘者,攻守変動,"手札",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,攻守変動,"墓地",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,攻守変動,"墓地",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,攻守変動,"除外",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,攻守変動,"除外",カウンタ)
NEXT

IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP
ENDIF

;新しく邪神変動を追加
FOR カウンタ,0,5
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%非ターンプレイヤー%_戦場:カウンタ")}(非ターンプレイヤー,邪神変動,"戦場",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%非ターンプレイヤー%_戦場:カウンタ")}(非ターンプレイヤー,邪神変動,"戦場",カウンタ)
NEXT
FOR カウンタ,0,5
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%ターンプレイヤー%_戦場:カウンタ")}(ターンプレイヤー,邪神変動,"戦場",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%ターンプレイヤー%_戦場:カウンタ")}(ターンプレイヤー,邪神変動,"戦場",カウンタ)
NEXT



@CONTINUOUS_NEGATE(決闘者)
#DIMS DYNAMIC 決闘者
#DIMS DYNAMIC 対面者
#DIM DYNAMIC カウンタ

決闘者 = %ターンプレイヤー%
CALL 対面者判定(決闘者)
対面者 = %RESULTS%
$INPUT_LOOP

FOR カウンタ,0,5
	VARSET RESULT
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,常在無効,"戦場",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_戦場:カウンタ")}(決闘者,常在無効,"戦場",カウンタ)
NEXT
FOR カウンタ,0,5
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,常在無効,"魔罠",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_魔罠:カウンタ")}(決闘者,常在無効,"魔罠",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,常在無効,"墓地",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_墓地:カウンタ")}(決闘者,常在無効,"墓地",カウンタ)
NEXT
FOR カウンタ,0,紙束最大値
	TRYCALLFORM CARDCAN_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,常在無効,"除外",カウンタ)
	SIF RESULT == 1
		TRYCALLFORM CARDEFFECT_{GETVAR(@"%決闘者%_除外:カウンタ")}(決闘者,常在無効,"除外",カウンタ)
NEXT

IF 決闘者 == ターンプレイヤー
	決闘者 = %対面者%
	GOTO INPUT_LOOP
ENDIF

