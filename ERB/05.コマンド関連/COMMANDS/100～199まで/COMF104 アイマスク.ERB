;-------------------------------------------------
;아이마스크
;SM계커맨드、レベル1
;-------------------------------------------------
@COM104
;着脱の処理
TEQUIP:아이마스크 = !TEQUIP:아이마스크

;-------------------------------------------------
;ソース추가処理
;-------------------------------------------------
;消費체력、기력
DOWNBASE:체력 += 0
DOWNBASE:기력 += 80

CALL SOURCE_CALC_拘束(TARGET, MASTER, 300)
;-------------------------------------------------
;특수ソース処理
;-------------------------------------------------
;긴박경험が高いと消費減少
IF EXP:구속경험 < EXPLV:3
	TIMES DOWNBASE:기력 , 1.00
ELSEIF EXP:구속경험 < EXPLV:4
	TIMES DOWNBASE:기력 , 0.90
ELSE
	TIMES DOWNBASE:기력 , 0.70
ENDIF

;-------------------------------------------------
;경험の処理
;-------------------------------------------------
EXP:구속경험 += 2
;同性愛　레즈なら戻り値1게이なら戻り値2
IF HETEROSEX(TARGET,MASTER)
	EXP:(50 + HETEROSEX(TARGET,MASTER)) += 1
	EXP:MASTER:(50 + HETEROSEX(TARGET,MASTER)) += 1
ENDIF

RETURN 1
;-------------------------------------------------
;装着계속の処理
;-------------------------------------------------
@EQUIP_COM104(ARG)
PRINTL ＜아이마스크 장착중＞

;-------------------------------------------------
;ソース추가処理
;-------------------------------------------------
DOWNBASE:ARG:체력 += 0
DOWNBASE:ARG:기력 += 40

CALL SOURCE_CALC_拘束(ARG, MASTER, 150)
;-------------------------------------------------
;특수ソース処理
;-------------------------------------------------
;긴박경험が高いと消費減少
LOCAL = 40
IF EXP:ARG:구속경험 < EXPLV:3
	TIMES LOCAL , 1.00
ELSEIF EXP:ARG:구속경험 < EXPLV:4
	TIMES LOCAL , 0.90
ELSE
	TIMES LOCAL , 0.70
ENDIF
DOWNBASE:ARG:기력 += LOCAL

;-------------------------------------------------
;경험の処理
;-------------------------------------------------
EXP:ARG:구속경험 ++

RETURN 1

;-------------------------------------------------
;実行판정
;-------------------------------------------------
@COM_ABLE104
;아이마스크実行판정
SIF !TFLAG:100
	RETURN 0
;一括관리
SIF GLOBAL_COMABLE(104)
	RETURN RESULT
;解除はいつでも可能
SIF TEQUIP:18
	RETURN 1
;아이템を持っているか、아이템なし설정でないとダメ
SIF ITEM:15 == 0 && NOITEM == 0
	RETURN 0
RETURN 1