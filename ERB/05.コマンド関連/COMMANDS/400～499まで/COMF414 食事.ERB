;식사
@COM414
#DIM DYNAMIC 調理レベル
#DIM DYNAMIC 価格
#DIM DYNAMIC 상승지방
#DIM DYNAMIC 回復率_체력
#DIM DYNAMIC 回復率_기력
CUSTOMDRAWLINE —
PRINTFORML 무엇을 먹으러 가시겠습니까？ (소지금:{MONEY}円)
CUSTOMDRAWLINE —
SELECTCASE CFLAG:MASTER:현재위치
	CASE 場所_식사通り
		PRINTFORML 
		SIF MONEY < 1000
			SETCOLOR C_GRAY
		PRINTFORML [1] - 카레라이스・모우얀（1000円）
		RESETCOLOR
		SIF MONEY < 5000
			SETCOLOR C_GRAY
		PRINTFORML [2] - 군관 진수부 번화가 시내（5000円）
		RESETCOLOR
		SIF MONEY < 1200
			SETCOLOR C_GRAY
		PRINTFORML [3] - 라멘 킹（1200円）
		RESETCOLOR
		SIF MONEY < 1500
			SETCOLOR C_GRAY
		PRINTFORML [4] - 곱빼기밥집、카　츠　동　★（1500円）
		RESETCOLOR
		SIF MONEY < 800
			SETCOLOR C_GRAY
		PRINTFORML [5] - 버거월드（800円）
		RESETCOLOR


	CASE 場所_モール
		SIF MONEY < 2380
			SETCOLOR C_GRAY
		PRINTFORML [30] - Auberge Poissonniere（2380円）
		RESETCOLOR
		SIF MONEY < 3200
			SETCOLOR C_GRAY
		PRINTFORML [31] - 불고기 전문접「수확제」（3200円）
		RESETCOLOR
		SIF MONEY < 1600
			SETCOLOR C_GRAY
		PRINTFORML [32] - 스위츠・스위트・쿠벨（1600円）
		RESETCOLOR
		SIF MONEY < 3800
			SETCOLOR C_GRAY
		PRINTFORML [33] - 도미노 피자（3800円）
		RESETCOLOR
		SIF MONEY < 2500
			SETCOLOR C_GRAY
		PRINTFORML [34] - 바이킹・오딘（2500円）
		RESETCOLOR
		SIF MONEY < 800
			SETCOLOR C_GRAY
		PRINTFORML [5] - 버거월드（800円）
		RESETCOLOR

	CASE 場所_商店街
		SIF MONEY < 2180
			SETCOLOR C_GRAY
		PRINTFORML [40] - 만족 스테이크（2180円）
		RESETCOLOR
		SIF MONEY < 150
			SETCOLOR C_GRAY
		PRINTFORML [41] - 1장 새티스팩션 바（150円）
		RESETCOLOR

		SIF MONEY < 120
			SETCOLOR C_GRAY
		PRINTFORML [42] - 우유（120円）
		RESETCOLOR

		SIF MONEY < 800
			SETCOLOR C_GRAY
		PRINTFORML [5] - 버거월드（800円）
		RESETCOLOR

	CASE 場所_銭湯
		SIF MONEY < 800
			SETCOLOR C_GRAY
		PRINTFORML [5] - 튀김소바（800円）
		RESETCOLOR
		SIF MONEY < 120
			SETCOLOR C_GRAY
		PRINTFORML [10] - 우유를 마신다（120円）
		RESETCOLOR
	CASE 場所_편의점
		SIF MONEY < 680
			SETCOLOR C_GRAY
		PRINTFORML [20] - 삼각김밥＋과자（680円）
		RESETCOLOR
		SIF MONEY < 210
			SETCOLOR C_GRAY
		PRINTFORML [21] - 에너지 드링크（210円）
		RESETCOLOR
		SIF MONEY < 680
			SETCOLOR C_GRAY
		PRINTFORML [22] - 샌드위치 세트（680円）
		RESETCOLOR
		SIF MONEY < 320
			SETCOLOR C_GRAY
		PRINTFORML [23] - 편의점 간식（320円）
		RESETCOLOR
	CASE 場所_ジム
		SIF MONEY < 1000
			SETCOLOR C_GRAY
		PRINTFORML [51] - 프로틴을 마신다（1000円）
		RESETCOLOR
ENDSELECT
PRINTFORML 
CUSTOMDRAWLINE —
PRINTFORML [0] - 돌아간다
BINPUT

TFLAG:SELECTCOM분기 = RESULT

SELECTCASE RESULT
CASE 0
	TFLAG:SELECTCOM분기 = 0
	RETURN 0
CASE 1
	価格 = 1000
	調理レベル = 5
	상승지방 += 15
CASE 2
	価格 = 5000
	調理レベル = 10
	상승지방 += 3
CASE 3
	価格 = 1200
	調理レベル = 6
	상승지방 += 30
CASE 4
	価格 = 1500
	調理レベル = 7
	상승지방 += 36
CASE 5
	価格 = 800
	調理レベル = 5
	상승지방 += 24

CASE 10
	価格 = 120
	調理レベル = 3
	상승지방 += 3
CASE 20
	価格 = 680
	調理レベル = 6
	상승지방 += 45
CASE 21
	価格 = 210
	調理レベル = 1
	상승지방 += 9
CASE 22
	価格 = 680
	調理レベル = 3
	상승지방 += 6
CASE 23
	価格 = 320
	調理レベル = 2
	상승지방 += 18

CASE 40
	価格 = 2180
	調理レベル = 9
	상승지방 += 24
CASE 41
	価格 = 150
	調理レベル = 2
	상승지방 += 3
CASE 42
	価格 = 120
	調理レベル = 3
	상승지방 += 3
CASE 51
	価格 = 1000
	;체력이 増えてくるとコストパフォーマンスが上がるように
	調理レベル = 1 + ((MAXBASE:MASTER:체력) / 5000)
	SIF 調理レベル > 9
		調理レベル = 9
	상승지방 += 5 + ((MAXBASE:MASTER:체력) / 1000)
	SIF 상승지방 > 40
		상승지방 = 40
ENDSELECT

IF MONEY < 価格
	PRINTL 돈이 부족합니다！
	RESTART
ENDIF


回復率_체력 += MAXBASE:MASTER:체력 / (11 - 調理レベル)
回復率_기력 += MAXBASE:MASTER:기력

FOR LOCAL,1,CHARANUM
	SIF CFLAG:LOCAL:현재위치 != CFLAG:MASTER:현재위치
		CONTINUE
	SIF CFLAG:LOCAL:수면
		CONTINUE
	SIF CFLAG:LOCAL:동행 == 0
		CONTINUE
	CALL RECOVER_PERMIL(LOCAL,回復率_체력,"체력",1)
	CALL RECOVER_PERMIL(LOCAL,回復率_기력,"기력",1)
	CFLAG:LOCAL:지방 += 상승지방
NEXT

CALL RECOVER_PERMIL(MASTER,回復率_체력,"체력",1)
CALL RECOVER_PERMIL(MASTER,回復率_기력,"기력",1)
EXP:MASTER:요리경험 += (調理レベル - 2)
CFLAG:MASTER:지방 += 상승지방
CALL MONEY_GET(-価格)
TCVAR:MASTER:식사가능여부 = 1440 * DAY + TIME
TIME += 60
RETURN 1


@CAN_COM414(ARG)
#DIM DYNAMIC 時間外
SKIPDISP ARG


IF TIME_PROGRESS(TCVAR:MASTER:식사가능여부) < 240
	PRINTFORMW 배가 가득 찼습니다。
ENDIF
SKIPDISP 0

SIF TIME_PROGRESS(TCVAR:MASTER:식사가능여부) < 240
	RETURN 0
RETURN 1


;-------------------------------------------------
;実行판정
;-------------------------------------------------
;식사
@COM_ABLE414
;식사実行판정
SIF !TFLAG:100
	RETURN 0
;一括관리
SIF GLOBAL_COMABLE(414)
	RETURN RESULT
;SIF TIME_PROGRESS(TCVAR:MASTER:식사가능여부) < 240
;	RETURN 0
SIF !FOODSTORE(CFLAG:MASTER:현재위치)
	RETURN 0
SIF CFLAG:우후후 == 2
	RETURN 0
RETURN 1
